```html
<!DOCTYPE html>
<html lang="zh-CN">
 <head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å†’é™©çŠ¶æ€</title>
  <style>
   /* --- åŸºç¡€æ ·å¼ --- */
   body {
    font-family: serif; /* ä½¿ç”¨é»˜è®¤è¡¬çº¿å­—ä½“ */
    background-color: #f5efe6;
    color: #4a3b31;
    margin: 0;
    padding: 15px;
    background-image: linear-gradient(to bottom, #fdfbf7, #f6f1e8); /* ä½¿ç”¨CSSæ¸å˜æ›¿ä»£å›¾ç‰‡ */
    background-size: cover;
    background-attachment: fixed;
   }

   /* --- ä¸»å®¹å™¨æ ·å¼ --- */
   .status-scroll {
    border: 2px solid #785a4e;
    border-radius: 8px;
    padding: 20px;
    background-color: rgba(240, 230, 210, 0.85);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.25), inset 0 0 10px rgba(0, 0, 0, 0.05);
    max-width: 900px;
    margin: auto;
    position: relative;
    overflow: hidden;
   }

   /* --- é¡¶éƒ¨ä¿¡æ¯æ¡† (æ—¶é—´å’Œåœ°ç‚¹) --- */
   .time-location-box {
    background-color: #e8ddcb;
    padding: 10px 15px;
    border-radius: 4px;
    margin-bottom: 15px;
    border: 1px solid #c6b8a5;
    text-align: left;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
   }
   .time-location-box:hover {
    transform: translateY(-3px);
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
   }

   /* --- é€šç”¨æ•°å€¼æ ·å¼ --- */
   .value-main {
    font-weight: 500;
    font-family: 'Courier New', monospace; /* ä¸ºæ•°å€¼ä¿ç•™ç­‰å®½å­—ä½“ */
    text-shadow: 0 0 2px rgba(0, 0, 0, 0.15), 0 0 5px rgba(255, 255, 255, 0.3);
   }

   /* --- æŠ˜å é¢æ¿ (details/summary) åŸºç¡€æ ·å¼ --- */
   details.section,
   details.sub-section,
   details.task-entry,
   details.skill-entry,
   details.destiny-target,
   details.inventory-item-entry,
   details.equipment-entry {
    margin-bottom: 6px;
    border: 1px solid #d3c5b3;
    border-radius: 4px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease-in-out;
   }
   details.section:hover,
   details.sub-section:hover,
   details.task-entry:hover,
   details.skill-entry:hover,
   details.destiny-target:hover,
   details.inventory-item-entry:hover,
   details.equipment-entry:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 15px rgba(0, 0, 0, 0.25);
   }

   /* --- æŠ˜å é¢æ¿æ ‡é¢˜ (summary) --- */
   details > summary {
    font-weight: 700;
    color: #5d4037;
    background-color: #d7c8b6;
    padding: 5px 15px;
    cursor: pointer;
    list-style: none;
    display: flex;
    align-items: center;
    border-bottom: 1px solid #c6b8a5;
    text-align: left;
    transition: background-color 0.2s ease, color 0.2s ease;
   }
   details > summary::-webkit-details-marker {
    display: none;
   }
   details > summary:hover {
    background-color: #cbb8a5;
    color: #4a3b31;
   }
   details[open] > summary {
    background-color: #bfa996;
    border-bottom-color: #a39281;
   }

   /* --- æŠ˜å é¢æ¿æ ‡é¢˜å·¦ä¾§çš„å‘å…‰æ˜Ÿæ˜Ÿå›¾æ ‡ --- */
   details > summary::before {
    content: 'âœ¦';
    font-size: 1.1em;
    color: #a39281;
    text-shadow: none;
    margin-right: 12px;
    flex-shrink: 0;
    transform-origin: center center;
    transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55), color 0.4s ease, text-shadow 0.4s ease;
   }
   details[open] > summary::before {
    transform: rotate(360deg);
    color: #f7d75a;
    text-shadow: 0 0 3px rgba(255, 255, 255, 0.8), 0 0 6px #f7d75a, 0 0 10px #e5a50a;
   }

   /* --- æŠ˜å é¢æ¿å³ä¾§çš„æŠ˜å ç®­å¤´ --- */
   .arrow-toggle {
    transition: transform 0.2s ease-in-out;
    font-size: 0.8em;
    padding-left: 5px;
    margin-left: auto;
   }
   details[open] > summary .arrow-toggle {
    transform: rotate(90deg);
   }

   /* --- æŠ˜å é¢æ¿å†…å®¹åŒºåŸŸ --- */
   .section-content,
   .sub-section-content,
   .task-content,
   .skill-description,
   .destiny-target-content,
   .inventory-item-details,
   .equipment-description {
    padding: 15px;
    background-color: rgba(253, 250, 245, 0.9);
    text-align: left;
    font-size: 0.9em;
    transition: background-color 0.2s ease, padding 0.2s ease, box-shadow 0.2s ease;
   }
   .skill-description,
   .passive-skill-item,
   .equipment-item {
    padding-top: 5px;
    padding-bottom: 5px;
   }
   .inventory-item-details {
    padding: 10px 15px;
   }

   /* --- å†…å®¹åŒºåŸŸé€šç”¨æ ·å¼ --- */
   .property,
   .inventory-category,
   .currency-item {
    margin-bottom: 8px;
    line-height: 1.6;
   }
   .property-name,
   .inventory-category p:first-child {
    font-weight: bold;
    color: #6a514d;
    text-shadow: 0 0 1px rgba(0, 0, 0, 0.08);
   }
   .passive-skill-description,
   .equipment-item .item-desc,
   .title-effect {
    font-size: 0.85em;
    font-style: italic;
    color: #7a655d;
    padding-left: 10px;
    margin-top: 2px;
   }
   .currency-item {
    padding-left: 15px;
   }

   /* --- è¿›åº¦æ¡æ ·å¼ --- */
   .progress-bar-container {
    background-color: #c8bbaf;
    border-radius: 9px;
    height: 18px;
    margin-top: 4px;
    margin-bottom: 8px;
    overflow: hidden;
    border: 1px solid rgba(0, 0, 0, 0.15);
    box-shadow: inset 0 1px 4px rgba(0, 0, 0, 0.2);
   }
   .progress-bar-value {
    height: 100%;
    width: 0%;
    transition: width 0.8s ease-out;
    border-radius: 9px;
    text-align: center;
    color: white;
    font-size: 0.7em;
    line-height: 18px;
    background-image: linear-gradient(to bottom, rgba(255,255,255,0.15), rgba(0,0,0,0.1));
    box-shadow: inset 0 -1px 3px rgba(0,0,0,0.1);
   }

   /* --- åˆ†éš”çº¿æ ·å¼ --- */
   .thin-divider {
    border: 0;
    margin: 10px 0;
    background: transparent url("data:image/svg+xml,%3Csvg width='100%25' height='1' viewBox='0 0 100 1' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cline x1='0' y1='0.5' x2='100' y2='0.5' stroke='%23B3A291' stroke-dasharray='3 3'/%3E%3C/svg%3E") repeat-x center;
    border-top: none;
    height: 1px;
   }

   /* --- ç‰¹å®šåŒºåŸŸå¾®è°ƒ --- */
   .bonds-skill-section {
    margin-top: 10px;
   }

   /* --- ç™»ç¥é•¿é˜¶ä¸“å±æ ·å¼ --- */
   .step-level-req {
    font-size: 0.8em;
    color: #7a655d;
    font-style: italic;
    margin-left: 15px;
   }
   .step-item {
     margin-bottom: 5px;
     line-height: 1.6;
   }
   .item-name {
     font-weight: bold;
     color: #6d4c41;
   }
   .item-desc {
     font-size: 0.9em;
     font-style: italic;
     color: #7a655d;
     margin-left: 20px;
     display: block;
   }
   .empty-slot {
     color: #9e9e9e;
     font-style: italic;
   }
   .god-tier-grid {
     display: grid;
     grid-template-columns: 1fr 1fr;
     gap: 20px;
   }
   details.sub-section.locked > summary {
    background-color: #e8e4e0;
    color: #b5aaa2;
    cursor: not-allowed;
   }
   details.sub-section.locked > summary::before {
    content: 'ğŸ”’';
    color: #b5aaa2;
   }


   /* --- æ–°é—»ç‰ˆå—æ ‡é¢˜æ ·å¼ --- */
   .news-headline {
    font-weight: 700;
   }
   .news-gold-lion {
    color: #b9892d;
   }
   .news-tavern {
    color: #6d4c41;
   }
   .news-tea-party {
    color: #c2185b;
   }

   /* --- éšè—å…ƒç´ çš„é€šç”¨ç±» --- */
   .hidden {
    display: none !important;
   }

   /* --- å³æ—¶çŠ¶æ€åˆ—è¡¨æ ·å¼ --- */
   .instant-status-item {
    margin-left: 15px;
    font-size: 0.9em;
    color: #4a3b31;
    line-height: 1.5;
    white-space: pre-wrap;
   }
   .instant-status-item span.status-name {
    font-weight: bold;
    color: #6a514d;
   }

   /* --- å¸ƒå±€ç½‘æ ¼ (Grid) --- */
   .status-grid {
    display: grid;
    grid-template-columns: 1fr auto 1fr;
    gap: 20px;
    align-items: start;
   }
   .status-grid-left,
   .status-grid-right {
    display: flex;
    flex-direction: column;
    gap: 8px;
   }
   .vertical-divider {
    width: 1px;
    background-color: #d3c5b3;
    align-self: stretch;
    margin: 0 5px;
    background: transparent url("data:image/svg+xml,%3Csvg width='1' height='100%25' viewBox='0 0 1 100' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cline x1='0.5' y1='0' x2='0.5' y2='100' stroke='%23D3C5B3' stroke-dasharray='3 3'/%3E%3C/svg%3E") repeat-y center;
   }

   /* --- äº¤äº’å…ƒç´  (æŒ‰é’®) --- */
   .action-button {
    background-color: #8d6e63;
    color: white;
    border: none;
    padding: 8px 12px;
    border-radius: 4px;
    cursor: pointer;
    font-family: sans-serif; /* ä½¿ç”¨é»˜è®¤æ— è¡¬çº¿å­—ä½“ */
    font-size: 0.9em;
    margin-bottom: 10px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    transition: all 0.2s ease;
   }
   .action-button:hover {
    background-color: #6d4c41;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    transform: translateY(-2px);
   }
   .action-button:active {
    transform: translateY(1px);
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
   }

   @media (max-width: 768px) {
    .status-grid {
     grid-template-columns: 1fr;
     gap: 10px;
    }
    .vertical-divider {
     display: none;
    }
    .status-grid-right {
     border-top: 1px solid #d3c5b3;
     padding-top: 10px;
    }
   }

   /* --- æŠ˜å æ æ ‡é¢˜ä¸­é—´çš„åŠ¨æ€ä¿¡æ¯æ ·å¼ --- */
   .summary-details {
    margin-left: auto;
    padding-right: 15px;
    font-family: 'Courier New', monospace; /* ä¸ºæ•°å€¼ä¿ç•™ç­‰å®½å­—ä½“ */
    font-weight: 500;
    font-size: 0.8em;
    color: #6a514d;
    letter-spacing: 0.5px;
    text-shadow: 0 0 1px rgba(0, 0, 0, 0.05);
    align-self: center;
   }

   /* --- [æ–°å¢] èƒŒåŒ…ç‰©å“æ•°é‡è§’æ ‡æ ·å¼ --- */
   .item-count-badge {
    margin-left: 8px;
    font-size: 0.8em;
    font-weight: bold;
    color: #fdfbf7;
    background-color: #785a4e;
    padding: 2px 6px;
    border-radius: 10px;
    line-height: 1;
    vertical-align: middle;
   }
  </style>
 </head>
 <body>
  <!-- ä¸»å®¹å™¨ -->
  <div class="status-scroll">
   <!-- æ—¶é—´å’Œåœ°ç‚¹ -->
   <div class="time-location-box">
    <p>â³ï¸ æ—¶é—´: <span id="world-time" class="value-main"></span></p>
    <p>ğŸ“ åœ°ç‚¹: <span id="world-location" class="value-main"></span></p>
   </div>

   <!-- ç™»ç¥é•¿é˜¶ -->
   <details class="section" id="ascension-section">
    <summary>â™¾ï¸ ç™»ç¥é•¿é˜¶ <span class="summary-details" id="ascension-summary-details"></span><span class="arrow-toggle">â–¼</span></summary>
    <div class="section-content">
     <!-- è¦ç´  -->
     <details class="sub-section" id="ascension-elements-details" open>
      <summary>è¦ç´  <span class="step-level-req">60çº§å¼€å¯</span><span class="arrow-toggle">â–¼</span></summary>
      <div class="sub-section-content">
       <div id="ascension-elements-list"></div>
       <p class="empty-slot hidden" id="no-elements-msg">ï¼ˆå°šæ— è¦ç´ ï¼‰</p>
      </div>
     </details>
     <!-- æƒèƒ½ -->
     <details class="sub-section" id="ascension-authority-details" open>
      <summary>æƒèƒ½ <span class="step-level-req">80çº§å¼€å¯</span><span class="arrow-toggle">â–¼</span></summary>
      <div class="sub-section-content">
       <div id="ascension-authority-list"></div>
       <p class="empty-slot hidden" id="no-authority-msg">ï¼ˆå°šæ— æƒèƒ½ï¼‰</p>
      </div>
     </details>
     <!-- æ³•åˆ™ -->
     <details class="sub-section" id="ascension-laws-details" open>
      <summary>æ³•åˆ™ <span class="step-level-req">90çº§å¼€å¯</span><span class="arrow-toggle">â–¼</span></summary>
      <div class="sub-section-content">
       <div id="ascension-laws-list"></div>
       <p class="empty-slot hidden" id="no-laws-msg">ï¼ˆå°šæ— æ³•åˆ™ï¼‰</p>
      </div>
     </details>
     <!-- ç¥ä½ / ç¥å›½ -->
     <details class="sub-section" id="ascension-divinity-details" open>
      <summary>ç¥ä½ / ç¥å›½ <span class="step-level-req">100çº§å¼€å¯</span><span class="arrow-toggle">â–¼</span></summary>
      <div class="sub-section-content">
       <div class="god-tier-grid">
         <div>
           <div class="step-item">
             <span class="item-name">ç¥ä½: </span>
             <span class="value-main" id="ascension-divinity-name"></span>
             <span class="empty-slot hidden" id="divinity-empty-slot">ï¼ˆå°šæœªç™»ä¸´ï¼‰</span>
           </div>
         </div>
         <div>
           <div class="step-item">
             <span class="item-name">ç¥å›½: </span>
             <span class="value-main" id="ascension-kingdom-name"></span>
             <span class="empty-slot hidden" id="kingdom-empty-slot">ï¼ˆå°šæœªå¼€è¾Ÿï¼‰</span>
           </div>
         </div>
       </div>
      </div>
     </details>
    </div>
   </details>

   <!-- å½“å‰ä»»åŠ¡ -->
   <details class="section" id="tasks-section">
    <summary>ğŸ“œ å½“å‰ä»»åŠ¡ <span class="summary-details" id="tasks-summary-details"></span><span class="arrow-toggle">â–¼</span></summary>
    <div class="section-content">
     <div id="tasks-list-container"></div>
     <p id="no-tasks-msg" class="hidden">ï¼ˆæš‚æ— ä»»åŠ¡ï¼‰</p>
    </div>
   </details>

   <!-- è§’è‰²ä¿¡æ¯ -->
   <details class="section" id="character-info-section">
    <summary>ğŸ‘¤ è§’è‰²åŸºæœ¬ä¿¡æ¯ <span class="summary-details" id="character-summary-details"></span><span class="arrow-toggle">â–¼</span></summary>
    <div class="section-content">

     <!-- è§’è‰²çŠ¶æ€ -->
     <details class="sub-section" id="character-status-section" open>
      <summary>ğŸ“Š è§’è‰²çŠ¶æ€ <span class="summary-details" id="character-status-summary-details"></span><span class="arrow-toggle">â–¼</span></summary>
      <div class="sub-section-content">
       <!-- èµ„æºæ¡: HP, MP, SP, EXP -->
       <div class="property">
        <span class="property-name">â¤ï¸ HP:</span>
        <span id="char-hp" class="value-main"></span> / <span id="char-hp-max" class="value-main"></span>
        <div class="progress-bar-container"><div id="char-hp-bar" class="progress-bar-value"></div></div>
       </div>
       <div class="property">
        <span class="property-name">ğŸ”® MP:</span>
        <span id="char-mp" class="value-main"></span> / <span id="char-mp-max" class="value-main"></span>
        <div class="progress-bar-container"><div id="char-mp-bar" class="progress-bar-value"></div></div>
       </div>
       <div class="property">
        <span class="property-name">âš¡ SP:</span>
        <span id="char-sp" class="value-main"></span> / <span id="char-sp-max" class="value-main"></span>
        <div class="progress-bar-container"><div id="char-sp-bar" class="progress-bar-value"></div></div>
       </div>
       <div class="property">
        <span class="property-name">ç´¯è®¡ç»éªŒ:</span> <span id="char-exp" class="value-main"></span> /
        <span id="char-exp-needed" class="value-main"></span>
        <div class="progress-bar-container"><div id="char-exp-bar" class="progress-bar-value"></div></div>
       </div>
       <hr class="thin-divider" />
       <!-- çŠ¶æ€ç½‘æ ¼å¸ƒå±€ -->
       <div class="status-grid">
        <!-- å·¦ä¾§ï¼šæˆ˜åŠ›å±‚çº§ã€ç­‰çº§ã€çŠ¶æ€ã€èº«ä»½ã€ç§°å·ç­‰ -->
        <div class="status-grid-left">
         <p><span class="property-name">âšœï¸ æˆ˜åŠ›å±‚çº§:</span> <span id="char-power-level" class="value-main"></span></p>
         <p><span class="property-name">âœ¨ ç­‰çº§:</span> <span id="char-level" class="value-main"></span></p>
         <p><span class="property-name">ğŸ§¬ ç§æ—:</span> <span id="char-race" class="value-main"></span></p>
         <hr class="thin-divider" />
         <p><span class="property-name">ğŸ‘‘ èº«ä»½:</span> <span id="char-identity" class="value-main">(æ— )</span></p>
         <p><span class="property-name">ğŸ”¥ å†’é™©è€…ç­‰çº§:</span> <span id="char-adventurer-rank" class="value-main">(æœªè¯„çº§)</span></p>
         <p><span class="property-name">ğŸ† ç§°å·:</span> <span id="char-title" class="value-main">(æ— )</span></p>
         <div class="title-effect">(<span id="char-title-effect" class="value-main">æ— </span>)</div>
        </div>
        <!-- åˆ†éš”çº¿ -->
        <div class="vertical-divider"></div>
        <!-- å³ä¾§ï¼šå±æ€§ç‚¹å’Œäº”ç»´å±æ€§ -->
        <div class="status-grid-right">
         <p><span class="property-name">å±æ€§ç‚¹ AP:</span> <span id="char-ap" class="value-main"></span></p>
         <div id="ap-display-container">
          <p><span class="property-name">ğŸ’ª åŠ›é‡ STR:</span> <span id="char-str-display" class="value-main"></span></p>
          <p><span class="property-name">ğŸ¤¸ æ•æ· AGI:</span> <span id="char-agi-display" class="value-main"></span></p>
          <p><span class="property-name">ğŸ‹ï¸ ä½“è´¨ CON:</span> <span id="char-con-display" class="value-main"></span></p>
          <p><span class="property-name">ğŸ§  æ™ºåŠ› INT:</span> <span id="char-int-display" class="value-main"></span></p>
          <p><span class="property-name">ğŸ§˜ ç²¾ç¥ SPI:</span> <span id="char-spi-display" class="value-main"></span></p>
         </div>
         <hr class="thin-divider" />
         <div class="property">
            <span class="property-name">ğŸ”˜ å³æ—¶çŠ¶æ€:</span>
            <div id="char-instant-status-container"></div>
            <p id="no-instant-status-msg" class="value-main">(æ­£å¸¸)</p>
         </div>
        </div>
       </div>
      </div>
     </details>

     <!-- è§’è‰²æŠ€èƒ½ -->
     <details class="sub-section" id="character-skills-section" >
      <summary>ğŸ’« è§’è‰²æŠ€èƒ½ <span class="arrow-toggle">â–¼</span></summary>
      <div class="sub-section-content" id="skills-list">
       <details class="sub-section" id="character-passive-skills-section" >
        <summary>ğŸ“Œ è¢«åŠ¨æŠ€èƒ½ <span class="arrow-toggle">â–¼</span></summary>
        <div class="sub-section-content" id="passive-skills-list-container"></div>
        <p id="no-passive-skills-msg" class="hidden">ï¼ˆå°šæœªæ‹¥æœ‰ä»»ä½•è¢«åŠ¨æŠ€èƒ½ï¼‰</p>
       </details>
       <hr class="thin-divider" />
       <details class="sub-section" id="character-active-skills-section" >
        <summary>ğŸŒ€ ä¸»åŠ¨æŠ€èƒ½ <span class="arrow-toggle">â–¼</span></summary>
        <div class="sub-section-content" id="active-skills-list-container"></div>
        <p id="no-active-skills-msg" class="hidden">ï¼ˆå°šæœªä¹ å¾—ä»»ä½•ä¸»åŠ¨æŠ€èƒ½ï¼‰</p>
       </details>
      </div>
     </details>

      <!-- è§’è‰²è£…å¤‡ -->
      <details class="sub-section" id="character-equipment-section" >
        <summary>âš”ï¸ è§’è‰²è£…å¤‡ <span class="arrow-toggle">â–¼</span></summary>
        <div class="sub-section-content" id="equipment-list-container"></div>
        <p id="no-equipment-msg" class="hidden">ï¼ˆæœªè£…å¤‡ä»»ä½•ç‰©å“ï¼‰</p>
      </details>

    </div>
   </details>

   <!-- è§’è‰²èƒŒåŒ… -->
   <details class="section" id="character-inventory-section">
    <summary>ğŸ’ è§’è‰²èƒŒåŒ… <span class="summary-details" id="inventory-summary-details"></span><span class="arrow-toggle">â–¼</span></summary>
    <div class="section-content">
     <div class="inventory-category">
      <p class="property-name">ğŸ’° è´§å¸:</p>
      <p class="currency-item">ğŸ’  ç™½é‡‘å¸: <span id="currency-platinum" class="value-main">0</span></p>
      <p class="currency-item">ğŸŸ¡ é‡‘å¸: <span id="currency-gold" class="value-main">0</span></p>
      <p class="currency-item">âšª é“¶å¸: <span id="currency-silver" class="value-main">0</span></p>
      <p class="currency-item">ğŸŸ¤ é“œå¸: <span id="currency-copper" class="value-main">0</span></p>
     </div>
     <hr class="thin-divider" />
     <div class="inventory-category">
      <p class="property-name">ğŸ“¦ ç‰©å“åˆ—è¡¨:</p>
      <details class="sub-section" >
       <summary>ğŸ—¡ï¸ æ­¦å™¨é˜²å…·<span id="inventory-equipment-count" class="item-count-badge"></span><span class="arrow-toggle">â–¼</span></summary>
       <div class="sub-section-content">
        <div id="inventory-equipment-container"></div>
        <p id="no-inventory-equipment-msg" class="hidden">ï¼ˆæ— ï¼‰</p>
       </div>
      </details>
      <details class="sub-section" >
       <summary>ğŸ§ª æ¶ˆè€—å“<span id="inventory-consumables-count" class="item-count-badge"></span><span class="arrow-toggle">â–¼</span></summary>
       <div class="sub-section-content">
        <div id="inventory-consumables-container"></div>
        <p id="no-consumables-msg" class="hidden">ï¼ˆæ— ï¼‰</p>
       </div>
      </details>
      <details class="sub-section" >
       <summary>ğŸŒ¿ ææ–™<span id="inventory-materials-count" class="item-count-badge"></span><span class="arrow-toggle">â–¼</span></summary>
       <div class="sub-section-content">
        <div id="inventory-materials-container"></div>
        <p id="no-materials-msg" class="hidden">ï¼ˆæ— ï¼‰</p>
       </div>
      </details>
      <details class="sub-section" >
       <summary>ğŸ å…¶å®ƒç‰©å“<span id="inventory-others-count" class="item-count-badge"></span><span class="arrow-toggle">â–¼</span></summary>
       <div class="sub-section-content">
        <div id="inventory-others-container"></div>
        <p id="no-others-msg" class="hidden">ï¼ˆæ— ï¼‰</p>
       </div>
      </details>
     </div>
    </div>
   </details>

   <!-- å‘½è¿çº¢çº¿ -->
   <details class="section" id="destiny-section">
    <summary>ğŸ’ å‘½è¿çº¢çº¿ <span class="summary-details" id="destiny-summary-details"></span><span class="arrow-toggle">â–¼</span></summary>
    <div class="section-content">
     <button id="system-shop-btn" class="action-button">ç³»ç»Ÿå•†åº—</button>
     <p><span class="property-name">ğŸ’– å‘½è¿ç‚¹æ•° FP:</span> <span id="destiny-fp" class="value-main">0</span></p>
     <div id="destiny-targets-container"></div>
     <p id="no-destiny-targets-msg" class="hidden">ï¼ˆå°šæœªä¸ä»»ä½•äººç¼”ç»“æ·±åˆ»çš„å‘½è¿è”ç³»ï¼‰</p>
    </div>
   </details>

   <!-- æ¯æ—¥è§é—» -->
   <details class="section" id="news-section">
    <summary>ğŸŒ æ¯æ—¥è§é—» <span class="arrow-toggle">â–¼</span></summary>
    <div class="section-content">
     <button id="update-news-btn" class="action-button">æ›´æ–°è§é—»</button>
     <details class="sub-section" id="news-gold-lion-section" open>
      <summary><span class="news-headline news-gold-lion">ğŸ¦ é‡‘ç‹®å¿«è®¯</span><span class="arrow-toggle">â–¼</span></summary>
      <div class="sub-section-content"><p id="news-gold-lion-text">ï¼ˆæš‚æ— æœ€æ–°å¿«è®¯ï¼‰</p></div>
     </details>
     <details class="sub-section" id="news-tavern-section" open>
      <summary><span class="news-headline news-tavern">ğŸ» é…’é¦†ç•™è¨€æ¿</span><span class="arrow-toggle">â–¼</span></summary>
      <div class="sub-section-content"><p id="news-tavern-text">ï¼ˆç•™è¨€æ¿ä¸Šç©ºç©ºå¦‚ä¹Ÿï¼‰</p></div>
     </details>
     <details class="sub-section" id="news-tea-party-section" open>
      <summary><span class="news-headline news-tea-party">â˜• ç³»ç»ŸåŠ©æ‰‹çš„åˆåèŒ¶ä¼š</span><span class="arrow-toggle">â–¼</span></summary>
      <div class="sub-section-content"><p id="news-tea-party-text">ï¼ˆèŒ¶ä¼šä¸Šæ²¡ä»€ä¹ˆæ–°å…«å¦ï¼‰</p></div>
     </details>
    </div>
   </details>
  </div>

  <script>
   // --- è¾…åŠ©å·¥å…·å‡½æ•° ---
   function SafeGetValue(obj, path, defaultValue = '') {
    try {
     const value = path.split('.').reduce((o, k) => (o && o[k] !== 'undefined' ? o[k] : undefined), obj);
     if (Array.isArray(value) && value.length > 0) {
      const firstEl = value[0];
      if(Object.keys(firstEl).length === 2 && 'v' in firstEl && 'd' in firstEl){
          return firstEl.v;
      }
      return firstEl;
     }
     return value ?? defaultValue;
    } catch(e) {
     return defaultValue;
    }
   }

   function updateProgressBar(barId, currentValue, maxValue, color = '#785A4E') {
    const progressBar = document.getElementById(barId);
    if (progressBar) {
     const current = parseFloat(currentValue) || 0;
     const max = parseFloat(maxValue) || 1;
     const percentage = Math.max(0, Math.min(100, (current / max) * 100));
     progressBar.style.width = `${percentage}%`;
     progressBar.style.backgroundColor = color;
    }
   }

   function setElementText(id, value, emptyValue = '') {
    const el = document.getElementById(id);
    if (el) el.innerText = (value === null || value === undefined || String(value).trim() === '') ? emptyValue : String(value).trim();
   }

   function setElementHTML(id, value, emptyValue = '') {
    const el = document.getElementById(id);
    if (el) {
     const finalValue = (value === null || value === undefined || String(value).trim() === '') ? emptyValue : String(value).trim();
     el.innerHTML = finalValue.replace(/\n/g, '<br />');
    }
   }

   function toggleElementVisibility(elementId, show) {
    document.getElementById(elementId)?.classList.toggle('hidden', !show);
   }

    function setupCollapsibles() {
        document.querySelectorAll('details.section').forEach(details => {
            details.open = false;
        });

        document.querySelectorAll('details > summary').forEach(summary => {
            const arrow = summary.querySelector('.arrow-toggle');
            if (arrow && !summary.dataset.listenerAttached) {
                summary.dataset.listenerAttached = 'true';
                summary.addEventListener('click', (event) => {
                    const detailsElement = summary.parentElement;
                    setTimeout(() => {
                        arrow.style.transform = detailsElement.open ? 'rotate(90deg)' : '';
                    }, 0);
                });
                const detailsElement = summary.parentElement;
                setTimeout(() => {
                    arrow.style.transform = detailsElement.open ? 'rotate(90deg)' : '';
                }, 0);
            }
        });
    }

   // --- æ•°æ®æ›´æ–°å‡½æ•° ---
    function updateWorldState(data) {
        setElementText('world-time', SafeGetValue(data, 'ä¸–ç•Œ.æ—¶é—´', 'æœªçŸ¥æ—¶é—´'));
        setElementText('world-location', SafeGetValue(data, 'ä¸–ç•Œ.åœ°ç‚¹', 'æœªçŸ¥åœ°ç‚¹'));
    }

   function updateAscensionLadder(data) {
        const ascensionData = SafeGetValue(data, 'ç™»ç¥é•¿é˜¶', {});
        const isAscensionOpen = SafeGetValue(ascensionData, 'æ˜¯å¦å¼€å¯') === 'æ˜¯';
        const userLevel = parseInt(SafeGetValue(data, 'è§’è‰².çŠ¶æ€.ç­‰çº§', '1'), 10);

        toggleElementVisibility('ascension-section', isAscensionOpen);

        if (!isAscensionOpen) return;

        const createStepItemHTML = (items, placeholderMsg) => {
            if (!items || typeof items !== 'object' || Object.keys(items).filter(k => k !== '$meta').length === 0) {
                return `<p class="empty-slot">${placeholderMsg}</p>`;
            }
            return Object.keys(items).filter(key => key !== '$meta').map(key => {
                const item = items[key];
                return `<div class="step-item"><span class="item-name">â– ${SafeGetValue(item, 'åç§°', key)}:</span><span class="item-desc">${SafeGetValue(item, 'æè¿°', 'æ— æè¿°')}</span></div>`;
            }).join('');
        };

        const elements = SafeGetValue(ascensionData, 'è¦ç´ ', {});
        document.getElementById('ascension-elements-list').innerHTML = createStepItemHTML(elements, 'ï¼ˆå°šæ— è¦ç´ ï¼‰');

        const authorities = SafeGetValue(ascensionData, 'æƒèƒ½', {});
        document.getElementById('ascension-authority-list').innerHTML = createStepItemHTML(authorities, 'ï¼ˆå°šæ— æƒèƒ½ï¼‰');

        const laws = SafeGetValue(ascensionData, 'æ³•åˆ™', {});
        document.getElementById('ascension-laws-list').innerHTML = createStepItemHTML(laws, 'ï¼ˆå°šæ— æ³•åˆ™ï¼‰');

        const divinity = SafeGetValue(ascensionData, 'ç¥ä½', {});
        const divinityName = Object.keys(divinity).filter(k => k !== '$meta')[0] || '';
        const kingdom = SafeGetValue(ascensionData, 'ç¥å›½', {});
        const kingdomName = kingdom[Object.keys(kingdom).filter(k => k !== '$meta')[0]]?.åç§° || '';

        setElementText('ascension-divinity-name', divinityName);
        toggleElementVisibility('divinity-empty-slot', !divinityName);

        setElementText('ascension-kingdom-name', kingdomName);
        toggleElementVisibility('kingdom-empty-slot', !kingdomName);

        let summaryText = 'é•¿é˜¶å·²å¯';
        if (divinityName) summaryText = `å·²ç™»ç¥: ${divinityName}`;
        else if (Object.keys(laws).filter(k => k !== '$meta').length > 0) summaryText = `å½“å‰é˜¶æ®µ: æ³•åˆ™`;
        else if (Object.keys(authorities).filter(k => k !== '$meta').length > 0) summaryText = `å½“å‰é˜¶æ®µ: æƒèƒ½`;
        else if (Object.keys(elements).filter(k => k !== '$meta').length > 0) summaryText = `å½“å‰é˜¶æ®µ: è¦ç´ `;
        setElementText('ascension-summary-details', summaryText);

        document.getElementById('ascension-elements-details').classList.toggle('locked', userLevel < 60);
        document.getElementById('ascension-authority-details').classList.toggle('locked', userLevel < 80);
        document.getElementById('ascension-laws-details').classList.toggle('locked', userLevel < 90);
        document.getElementById('ascension-divinity-details').classList.toggle('locked', userLevel < 100);
   }


   function updateTasks(data) {
        const taskList = SafeGetValue(data, 'ä»»åŠ¡åˆ—è¡¨', {});
        const container = document.getElementById('tasks-list-container');
        container.innerHTML = '';

        const taskKeys = Object.keys(taskList).filter(key => key !== '$meta' && taskList[key] && taskList[key]['æ ‡é¢˜']);

        taskKeys.forEach(key => {
            const task = taskList[key];
            const title = SafeGetValue(task, 'æ ‡é¢˜', 'æ— æ ‡é¢˜ä»»åŠ¡');
            const intro = SafeGetValue(task, 'ç®€ä»‹', 'æ— ');
            const target = SafeGetValue(task, 'ç›®æ ‡', 'æ— ');
            const reward = SafeGetValue(task, 'å¥–åŠ±', 'æ— ');

            const taskHtml = `<details class="task-entry" open>
                                <summary>ğŸš© <span class="value-main">${title}</span> <span class="arrow-toggle">â–¼</span></summary>
                                <div class="task-content">
                                    <p>ğŸ“– ç®€ä»‹: <span class="value-main">${intro}</span></p>
                                    <p>ğŸ¯ ç›®æ ‡: <span class="value-main">${target}</span></p>
                                    <p>ğŸ† å¥–åŠ±: <span class="value-main">${reward}</span></p>
                                </div>
                              </details>`;
            container.innerHTML += taskHtml;
        });

        setElementText('tasks-summary-details', `è¿›è¡Œä¸­: ${taskKeys.length}ä¸ª`);
        toggleElementVisibility('no-tasks-msg', taskKeys.length === 0);
   }

   function updateCharacterResources(data) {
        const paths = {
            hp: { current: 'è§’è‰².èµ„æº.ç”Ÿå‘½å€¼', max: 'è§’è‰².èµ„æº.ç”Ÿå‘½å€¼ä¸Šé™', color: '#D32F2F' },
            mp: { current: 'è§’è‰².èµ„æº.æ³•åŠ›å€¼', max: 'è§’è‰².èµ„æº.æ³•åŠ›å€¼ä¸Šé™', color: '#1976D2' },
            sp: { current: 'è§’è‰².èµ„æº.ä½“åŠ›å€¼', max: 'è§’è‰².èµ„æº.ä½“åŠ›å€¼ä¸Šé™', color: '#388E3C' },
            exp: { current: 'è§’è‰².çŠ¶æ€.ç´¯è®¡ç»éªŒå€¼', max: 'è§’è‰².çŠ¶æ€.å‡çº§æ‰€éœ€ç»éªŒ', color: '#FFA000' }
        };

        for (const [key, p] of Object.entries(paths)) {
            const current = SafeGetValue(data, p.current, '0');
            const max = SafeGetValue(data, p.max, '1');
            setElementText(`char-${key}`, current);
            setElementText(`char-${key}-${key === 'exp' ? 'needed' : 'max'}`, max);
            updateProgressBar(`char-${key}-bar`, current, max, p.color);
        }
   }

   function updateCharacterStatus(data) {
        setElementText('char-power-level', SafeGetValue(data, 'è§’è‰².çŠ¶æ€.æˆ˜åŠ›å±‚çº§', 'æœªçŸ¥'));
        setElementText('char-level', SafeGetValue(data, 'è§’è‰².çŠ¶æ€.ç­‰çº§', '1'));
        setElementText('char-race', SafeGetValue(data, 'è§’è‰².ç§æ—', 'æœªçŸ¥'));
        setElementText('char-identity', SafeGetValue(data, 'è§’è‰².çŠ¶æ€.èº«ä»½', 'æ— '));
        setElementText('char-adventurer-rank', SafeGetValue(data, 'è§’è‰².çŠ¶æ€.å†’é™©è€…ç­‰çº§', 'æœªè¯„çº§'));
        setElementText('char-title', SafeGetValue(data, 'è§’è‰².çŠ¶æ€.ç§°å·', 'æ— '));
        setElementText('char-title-effect', SafeGetValue(data, 'è§’è‰².çŠ¶æ€.ç§°å·æ•ˆæœ', 'æ— '));

        const statusObj = SafeGetValue(data, 'è§’è‰².çŠ¶æ€.å³æ—¶çŠ¶æ€', {});
        const statusContainer = document.getElementById('char-instant-status-container');
        statusContainer.innerHTML = '';
        const statusKeys = Object.keys(statusObj).filter(key => key !== '$meta' && statusObj[key] && SafeGetValue(statusObj[key], 'åç§°'));

        statusKeys.forEach(key => {
            const s = statusObj[key];
            let text = `<span class="status-name">${SafeGetValue(s, 'åç§°', key)}</span>`;
            if (SafeGetValue(s, 'æ•ˆæœ')) text += `: ${SafeGetValue(s, 'æ•ˆæœ')}`;
            if (SafeGetValue(s, 'æŒç»­')) text += ` (${SafeGetValue(s, 'æŒç»­')})`;
            statusContainer.innerHTML += `<p class="instant-status-item">- ${text}</p>`;
        });

        toggleElementVisibility('no-instant-status-msg', statusKeys.length === 0);
   }

   function updateCharacterAttributes(data) {
        setElementText('char-ap', SafeGetValue(data, 'è§’è‰².å±æ€§.å±æ€§ç‚¹', '0'));
        const statIds = { 'åŠ›é‡': 'str', 'æ•æ·': 'agi', 'ä½“è´¨': 'con', 'æ™ºåŠ›': 'int', 'ç²¾ç¥': 'spi' };
        for(const [stat, id] of Object.entries(statIds)){
            setElementText(`char-${id}-display`, SafeGetValue(data, `è§’è‰².å±æ€§.${stat}`, '0'));
        }
   }

    function updateSkills(data) {
        const skillList = SafeGetValue(data, 'æŠ€èƒ½åˆ—è¡¨', {});
        const passiveContainer = document.getElementById('passive-skills-list-container');
        const activeContainer = document.getElementById('active-skills-list-container');
        passiveContainer.innerHTML = '';
        activeContainer.innerHTML = '';

        const skillKeys = Object.keys(skillList).filter(key => key !== '$meta' && skillList[key] && SafeGetValue(skillList[key], 'åç§°'));

        let passiveCount = 0;
        let activeCount = 0;

        skillKeys.forEach(key => {
            const s = skillList[key];
            const name = SafeGetValue(s, 'åç§°');
            const quality = SafeGetValue(s, 'å“è´¨', 'æ™®é€š');
            const desc = SafeGetValue(s, 'æè¿°');

            if (SafeGetValue(s, 'ç±»å‹') === 'è¢«åŠ¨') {
                passiveContainer.innerHTML += `<details class="skill-entry" open><summary><span class="value-main">${name} (${quality})</span> <span class="arrow-toggle">â–¼</span></summary><div class="skill-description">${desc}</div></details>`;
                passiveCount++;
            } else {
                const cost = SafeGetValue(s, 'æ¶ˆè€—', 'æ— ');
                activeContainer.innerHTML += `<details class="skill-entry" open><summary><span class="value-main">${name} (${quality}) | ${cost}</span> <span class="arrow-toggle">â–¼</span></summary><div class="skill-description">${desc}</div></details>`;
                activeCount++;
            }
        });

        toggleElementVisibility('no-passive-skills-msg', passiveCount === 0);
        toggleElementVisibility('no-active-skills-msg', activeCount === 0);
    }

   function updateEquipment(data) {
        const equipmentObj = SafeGetValue(data, 'è´¢äº§.è£…å¤‡', {});
        const container = document.getElementById('equipment-list-container');
        container.innerHTML = '';
        const equipKeys = Object.keys(equipmentObj).filter(key => key !== '$meta' && equipmentObj[key] && SafeGetValue(equipmentObj[key], 'åç§°'));

        equipKeys.forEach(key => {
            const item = equipmentObj[key];
            container.innerHTML += `<div class="equipment-item"><p class="property-name">${SafeGetValue(item, 'éƒ¨ä½')}: ${SafeGetValue(item, 'åç§°')}(${SafeGetValue(item, 'å“è´¨')})</p><div class="item-desc">${SafeGetValue(item, 'æè¿°')}</div></div>`;
        });

        toggleElementVisibility('no-equipment-msg', equipKeys.length === 0);
   }

   function updateInventory(data) {
        const currency = SafeGetValue(data, 'è´¢äº§.è´§å¸', {});
        setElementText('currency-platinum', SafeGetValue(currency, 'ç™½é‡‘å¸', '0'));
        setElementText('currency-gold', SafeGetValue(currency, 'é‡‘å¸', '0'));
        setElementText('currency-silver', SafeGetValue(currency, 'é“¶å¸', '0'));
        setElementText('currency-copper', SafeGetValue(currency, 'é“œå¸', '0'));
        setElementText('inventory-summary-details', `ç™½é‡‘å¸:${SafeGetValue(currency, 'ç™½é‡‘å¸','0')} é‡‘:${SafeGetValue(currency, 'é‡‘å¸','0')} é“¶:${SafeGetValue(currency, 'é“¶å¸','0')} é“œ:${SafeGetValue(currency, 'é“œå¸','0')}`);

        const inventory = SafeGetValue(data, 'è´¢äº§.èƒŒåŒ…', {});
        const itemKeys = Object.keys(inventory).filter(key => key !== '$meta' && inventory[key] && SafeGetValue(inventory[key], 'åç§°'));

        const categories = { consumables: [], equipment: [], materials: [], others: [] };
        itemKeys.forEach(key => {
            const item = inventory[key];
            const type = SafeGetValue(item, 'ç±»å‹', 'å…¶å®ƒç‰©å“');
            if (type === 'æ¶ˆè€—å“') categories.consumables.push(item);
            else if (['æ­¦å™¨', 'é˜²å…·', 'é¥°å“'].includes(type)) categories.equipment.push(item);
            else if (type === 'ææ–™') categories.materials.push(item);
            else categories.others.push(item);
        });

        const createItemHtml = (items) => items.map(i => `<details class="inventory-item-entry" open><summary><span class="value-main">${SafeGetValue(i, 'åç§°')}(${SafeGetValue(i, 'å“è´¨','æ™®é€š')}) | ${SafeGetValue(i, 'æ•°é‡', '1')}</span><span class="arrow-toggle">â–¼</span></summary><div class="inventory-item-details"><p><span class="property-name">ç±»å‹:</span> ${SafeGetValue(i, 'ç±»å‹')}</p><p><span class="property-name">æè¿°:</span> ${SafeGetValue(i, 'æè¿°')}</p></div></details>`).join('');

        ['equipment', 'consumables', 'materials', 'others'].forEach(cat => {
            const container = document.getElementById(`inventory-${cat}-container`);
            container.innerHTML = createItemHtml(categories[cat]);
            document.getElementById(`inventory-${cat}-count`).textContent = categories[cat].length > 0 ? categories[cat].length : '';
            toggleElementVisibility(`no-${cat === 'equipment' ? 'inventory-equipment' : cat}-msg`, categories[cat].length === 0);
        });
   }

   function updateDestinySystem(data) {
        const destinyData = SafeGetValue(data, 'å‘½è¿ç³»ç»Ÿ', {});
        setElementText('destiny-fp', SafeGetValue(destinyData, 'å‘½è¿ç‚¹æ•°', '0'));

        const targets = SafeGetValue(destinyData, 'çº¢çº¿å¯¹è±¡', {});
        const container = document.getElementById('destiny-targets-container');
        container.innerHTML = '';
        const targetKeys = Object.keys(targets).filter(key => key !== '$meta' && targets[key] && SafeGetValue(targets[key], 'åç§°'));

        const barsToUpdate = [];
        targetKeys.forEach(key => {
            const char = targets[key];
            const barId = `destiny-target-${key.replace(/\s+/g, '-')}-affection-bar`;
            container.innerHTML += createDestinyTargetHTML(char, barId);
            barsToUpdate.push({ barId: barId, current: parseInt(SafeGetValue(char, 'å¥½æ„Ÿåº¦', '0'), 10), max: 1000 });
        });

        setElementText('destiny-summary-details', `FP: ${SafeGetValue(destinyData, 'å‘½è¿ç‚¹æ•°','0')} | çº¢çº¿: ${targetKeys.length}äºº`);
        toggleElementVisibility('no-destiny-targets-msg', targetKeys.length === 0);
        barsToUpdate.forEach(b => updateProgressBar(b.barId, b.current, b.max, '#EC407A'));
   }

   function createDestinyTargetHTML(character, barId) {
        const createRow = (emoji, label, valuePath, defaultValue = 'æœªçŸ¥') => {
            const value = SafeGetValue(character, valuePath, defaultValue);
            if (value === null || value === 'æœªçŸ¥' || String(value).trim() === '') {
                return ''; // å¦‚æœå€¼ä¸ºç©ºã€æœªçŸ¥æˆ–ç©ºç™½ï¼Œåˆ™ä¸æ¸²æŸ“è¯¥è¡Œ
            }
            return `<p><span class="property-name">${emoji} ${label}:</span> <span class="value-main">${value}</span></p>`;
        }
        const name = SafeGetValue(character, 'åç§°');
        const isTied = SafeGetValue(character, 'æ˜¯å¦ç¼”ç»“çº¢çº¿', 'å¦') === 'æ˜¯';

        return `<details class="destiny-target" open>
                    <summary><span class="value-main">${name}</span> <span class="arrow-toggle">â–¼</span></summary>
                    <div class="destiny-target-content">
                        ${createRow('âšœï¸', 'æˆ˜åŠ›å±‚çº§', 'æˆ˜åŠ›å±‚çº§')}
                        ${createRow('âœ¨', 'ç­‰çº§', 'ç­‰çº§', '1')}
                        ${createRow('ğŸ§¬', 'ç§æ—', 'ç§æ—')}
                        ${createRow('ğŸ‘‘', 'èº«ä»½', 'èº«ä»½', 'æ— ')}
                        ${createRow('âš–ï¸', 'èŒä¸š', 'èŒä¸š', 'æ— ')}
                        ${createRow('ğŸ­', 'æ€§æ ¼', 'æ€§æ ¼')}
                        ${createRow('ğŸ’–', 'å–œçˆ±', 'å–œçˆ±')}
                        ${createRow('ğŸŒ¸', 'å¤–è²Œç‰¹è´¨', 'å¤–è²Œç‰¹è´¨')}
                        ${createRow('ğŸ‘—', 'è¡£ç‰©è£…é¥°', 'è¡£ç‰©è£…é¥°')}
                        ${createRow('âš”ï¸', 'è§’è‰²è£…å¤‡', 'è§’è‰²è£…å¤‡', 'æ— ')}
                        <hr class="thin-divider">
                        <p><span class="property-name">ğŸª¢ æ˜¯å¦ç¼”ç»“çº¢çº¿:</span> <span class="value-main">${isTied ? 'æ˜¯' : 'å¦'}</span></p>
                        <p><span class="property-name">â¤ï¸ å¥½æ„Ÿåº¦:</span> <span class="value-main">${SafeGetValue(character, 'å¥½æ„Ÿåº¦', '0')} / 1000</span></p>
                        <div class="progress-bar-container"><div id="${barId}" class="progress-bar-value"></div></div>
                        <p><span class="property-name">ğŸ’­ è¯„ä»·:</span> <span class="value-main">${SafeGetValue(character, 'è¯„ä»·', 'ï¼ˆæš‚æ— è¯„ä»·ï¼‰')}</span></p>
                        ${createRow('â™¾ï¸', 'ç™»ç¥é•¿é˜¶', 'ç™»ç¥é•¿é˜¶', 'æœªå¼€å¯')}
                        ${createRow('ğŸ“œ', 'èƒŒæ™¯æ•…äº‹', 'èƒŒæ™¯æ•…äº‹', 'æš‚æ— ')}
                    </div>
                </details>`;
   }

   function updateNews(data) {
        const newsData = SafeGetValue(data, 'æ¯æ—¥è§é—»', {});
        setElementHTML('news-gold-lion-text', SafeGetValue(newsData, 'é‡‘ç‹®å¿«è®¯', '').replace(/\|/g, '<br>'), 'ï¼ˆæš‚æ— æœ€æ–°å¿«è®¯ï¼‰');
        setElementHTML('news-tavern-text', SafeGetValue(newsData, 'é…’é¦†ç•™è¨€æ¿', '').replace(/\|/g, '<br>'), 'ï¼ˆç•™è¨€æ¿ä¸Šç©ºç©ºå¦‚ä¹Ÿï¼‰');
        setElementHTML('news-tea-party-text', SafeGetValue(newsData, 'ç³»ç»ŸåŠ©æ‰‹çš„åˆåèŒ¶ä¼š', '').replace(/\|/g, '<br>'), 'ï¼ˆèŒ¶ä¼šä¸Šæ²¡ä»€ä¹ˆæ–°å…«å¦ï¼‰');
   }

   function updateAllSummaryDetails(data){
       const summaryText = `${SafeGetValue(data, 'è§’è‰².çŠ¶æ€.æˆ˜åŠ›å±‚çº§','æœªçŸ¥')} | Lv.${SafeGetValue(data, 'è§’è‰².çŠ¶æ€.ç­‰çº§', '1')} | ${SafeGetValue(data, 'è§’è‰².çŠ¶æ€.ç§°å·','æ— ç§°å·')}`;
       setElementText('character-summary-details', summaryText);

       const hp = `${SafeGetValue(data,'è§’è‰².èµ„æº.ç”Ÿå‘½å€¼','0')}/${SafeGetValue(data,'è§’è‰².èµ„æº.ç”Ÿå‘½å€¼ä¸Šé™','0')}`;
       const mp = `${SafeGetValue(data,'è§’è‰².èµ„æº.æ³•åŠ›å€¼','0')}/${SafeGetValue(data,'è§’è‰².èµ„æº.æ³•åŠ›å€¼ä¸Šé™','0')}`;
       const sp = `${SafeGetValue(data,'è§’è‰².èµ„æº.ä½“åŠ›å€¼','0')}/${SafeGetValue(data,'è§’è‰².èµ„æº.ä½“åŠ›å€¼ä¸Šé™','0')}`;
       setElementText('character-status-summary-details', `HP: ${hp} | MP: ${mp} | SP: ${sp}`);
   }


   function setupStaticEventListeners() {
    const shopButton = document.getElementById('system-shop-btn');
    if (shopButton && !shopButton.dataset.listenerAttached) {
      shopButton.addEventListener('click', () => {
        if (typeof triggerSlash === 'function') triggerSlash('/send æ‰“å¼€ç³»ç»Ÿå•†åº—|/trigger');
      });
      shopButton.dataset.listenerAttached = 'true';
    }
    const newsButton = document.getElementById('update-news-btn');
    if (newsButton && !newsButton.dataset.listenerAttached) {
      newsButton.addEventListener('click', () => {
         if (typeof triggerSlash === 'function') triggerSlash('/send æ›´æ–°æ¯æ—¥è§é—»|/trigger');
      });
      newsButton.dataset.listenerAttached = 'true';
    }
   }

   // --- ä¸»åˆå§‹åŒ–å‡½æ•° ---
   async function initDisplay() {
    try {
     const messages = await getChatMessages(getCurrentMessageId());
     const latestMessage = messages && messages.length > 0 ? messages[messages.length - 1] : null;
     const characterData = latestMessage?.data?.stat_data;

     if (!characterData) {
      console.error('çŠ¶æ€æ åŠ è½½å¤±è´¥: æ‰¾ä¸åˆ° stat_dataã€‚');
      return;
     }

     updateWorldState(characterData);
     updateAscensionLadder(characterData);
     updateTasks(characterData);
     updateCharacterResources(characterData);
     updateCharacterStatus(characterData);
     updateCharacterAttributes(characterData);
     updateSkills(characterData);
     updateEquipment(characterData);
     updateInventory(characterData);
     updateDestinySystem(characterData);
     updateNews(characterData);
     updateAllSummaryDetails(characterData);

     setupStaticEventListeners();
     setupCollapsibles();

    } catch (error) {
     console.error('çŠ¶æ€æ åŠ è½½æ—¶å‘ç”Ÿä¸¥é‡é”™è¯¯:', error);
     document.body.innerHTML = `<p style='color:red; padding:20px; text-align:center;'>çŠ¶æ€æ åŠ è½½å¤±è´¥ï¼ Error: ${error.message}</p>`;
    }
   }

   document.addEventListener('DOMContentLoaded', initDisplay);
  </script>
 </body>
</html>
```